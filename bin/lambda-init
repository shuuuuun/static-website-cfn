#!/bin/sh

set -eu

# TODO: functions以下にある関数すべて作成する

ROOT_PATH="$(cd "$(dirname $0)/../"; pwd)"
source "$ROOT_PATH/bin/lambda-env"

FUNCTION_NAME="basic_auth"
func_dir="$ROOT_PATH/functions/$FUNCTION_NAME"
tmp_file="tmp.zip"

cd "$ROOT_PATH"
zip -r "$tmp_file" "$func_dir"
aws lambda create-function \
  --region $AWS_REGION \
  --profile $AWS_PROFILE \
  --function-name $FUNCTION_NAME \
  --runtime $RUNTIME \
  --role $ROLE \
  --handler $HANDLER \
  --zip-file fileb://$tmp_file
